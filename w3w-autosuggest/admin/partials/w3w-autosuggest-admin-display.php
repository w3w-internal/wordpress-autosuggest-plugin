<?php

/**
 * Provide an admin area view for the plugin
 *
 * This file is used to markup the admin-facing aspects of the plugin.
 *
 * @link       https://developer.what3words.com/tutorial/installing-the-wordpress-plugin
 * @since      4.0.0
 *
 * @package    W3W_Autosuggest
 * @subpackage W3W_Autosuggest/admin/partials
 */

$settings = get_option( $this->settings_name );

?>

<!-- This file should primarily consist of HTML with a little bit of PHP. -->
<div class="wrap">
  <div class="container-md">

  <div class="wp-header-end"></div>

    <div class="row">
      <div class="col max-width">

        <!--- Block: API Key --->
        <div class="row g-0 mb-4">
          <div class="col-md-9 bg-white py-3 px-3" style="max-width: 540px;">
            <div class="row g-0">
              
              <!--- Logo --->
              <div class="col-12 mb-2">
                <?php require_once( plugin_dir_path( __DIR__ ) . '/img/logo.svg' ); ?>
              </div>

              <div class="col-12 fs-3 mb-3">what3words Address Field</div>
              <div class="col-12 text mb-3">
                Add a what3words address field to your checkout page for validated entries, and precise delivery
                locations.
              </div>
              <?php if ( !$settings['api_key'] ) { ?>
              <div class="col-12 text mb-3">
                Before you can use the what3words search field, you will need to get a what3words API key.
              </div>
              <div class="col-12 text mb-3 w3w-warning p-3">
                <span class="fw-bold">Warning - </span>Your plugin will not validate entries until a what3words API key has been entered.
              </div>
              <div class="col-12 mb-3">
                <a
                  id="get_api_key"
                  class="button button-primary"
                  href="https://what3words.com/select-plan"
                  target="_blank"
                  data-testid="get_api_key">
                  Get an API key
                </a>
              </div>
              <?php } ?>
              <form method="POST" action="<?php echo $this->settings_url; ?>">
                <input type="hidden" name="api_key_form" value="1">
                <div class="col-12 mb-3">
                  <div class="row g-1">
                    <div class="col-12">
                      <label for="w3w_api_key" class="form-label fw-bold">API Key (required)</label>
                    </div>
                    <div class="col-12">
                      <input
                        type="text"
                        class="form-control form-control-lg"
                        id="w3w_api_key"
                        name="api_key"
                        value="<?php echo $settings['api_key']; ?>"
                        tabindex="1"
                        data-testid="api_key">
                    </div>
                    <div class="col d-flex align-items-center">
                      <button
                        id="api_key_btn"
                        type="submit"
                        class="button button-primary"
                        tabindex="2"
                        disabled
                        data-testid="save_api_key">Save</button>
                    </div>
                  </div>
                </div>
              </form>
              <?php if ( $settings['api_key'] ) { ?>
              <div class="col-12 mb-3 text" data-testid="manage_api_key">
                Manage your API keys in your <a href="https://accounts.what3words.com" class="btn-link" target="_blank">what3words account</a>.
              </div>
              <?php } ?>
            </div>
          </div>

          <div
            class="col-md bg-white d-none d-md-block w3w-bg"
            style="background: url('<?php echo plugin_dir_url( __DIR__ ) . '/img/phone-mockup.png'; ?>'); background-size: 253px auto; background-repeat: no-repeat; background-position: 10px 24px;">
          </div>
        </div>

        <!--- Block: Settings --->
        <?php require_once( plugin_dir_path( __FILE__ ) . 'w3w-autosuggest-settings.php' ); ?>

        <!--- Block: Advanced Settings --->
        <?php require_once( plugin_dir_path( __FILE__ ) . 'w3w-autosuggest-advanced.php' ); ?>
        

        <!--- Block: Troubleshooting --->
        <div class="row g-0 mb-4">
          <div class="col-12 bg-white py-3 px-3 mb-3">
            <div class="row g-0 dropstart">
              <div class="col-12 fs-3 dropdown-toggle mb-3" tabindex="28">Troubleshooting</div>
              <div class="menu d-none">
                <div class="col-12 text mb-3">
                  If you encounter any unexpected behaviour with the plugin or have issues with the field appearing on your checkout, please contact us at <a href="mailto:support@what3words.com" class="btn-link">support@what3words.com</a> and we'll be happy to help you.
                </div>

                <div class="col-12 text mb-3">
                  If you believe there is another checkout plugin conflicting with the what3words plugin, please give us as much detail as possible to assist with helping you.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
